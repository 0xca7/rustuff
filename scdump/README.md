# scdump

Just a little program that takes objdump input and pulls out shellcode.
Works for Intel Syntax, x86/x86-64 only.

Usage:

```
# note that you have to specify the target function as "<*>"
objdump -M intel -d ~/tmp/a.out | scdump --target-function "<main>"

# result
\xf3\x0f\x1e\xfa\x55\x48\x89\xe5\x48\x83\xec\x30\x89\x7d\xdc\x48\x89\x75\xd0\x64\x48\x8b\x04\x25\x28\x00\x00\x00\x48\x89\x45\xf8\x31\xc0\x48\xc7\x45\xf0\x00\x00\x00\x00\x48\xc7\x45\xe8\x00\x00\x00\x00\xc7\x45\xe4\x00\x00\x00\x00\x83\x7d\xdc\x02\x74\x28\x48\x8d\x05\xd9\x0c\x00\x00\x48\x89\xc7\xe8\x09\xfe\xff\xff\x48\x8d\x05\xec\x0c\x00\x00\x48\x89\xc7\xe8\xfa\xfd\xff\xff\xbf\x01\x00\x00\x00\xe8\x90\xfe\xff\xff\x48\x8b\x45\xd0\x48\x83\xc0\x08\x48\x8b\x00\x48\x8d\x55\xe8\x48\x89\xd6\x48\x89\xc7\xe8\x48\x00\x00\x00\x48\x89\x45\xf0\x48\x83\x7d\xf0\x00\x74\x22\x48\x8b\x55\xe8\x48\x8b\x45\xf0\x48\x89\xd6\x48\x89\xc7\xe8\x75\x02\x00\x00\x89\x45\xe4\x48\x8b\x45\xf0\x48\x89\xc7\xe8\x89\xfd\xff\xff\xb8\x00\x00\x00\x00\x48\x8b\x55\xf8\x64\x48\x2b\x14\x25\x28\x00\x00\x00\x74\x05\xe8\xc0\xfd\xff\xff\xc9\xc3
produced 753 bytes of output
```

This tool can also dump as a C-struct:

```
# command
objdump -M intel -d ~/tmp/a.out | scdump --target-function "<main>" --structmode

# result
{ 0x0012e9, "\xf3\x0f\x1e\xfa", 4 },
{ 0x0012ed, "\x55", 1 },
{ 0x0012ee, "\x48\x89\xe5", 3 },
{ 0x0012f1, "\x48\x83\xec\x30", 4 },
{ 0x0012f5, "\x89\x7d\xdc", 3 },
{ 0x0012f8, "\x48\x89\x75\xd0", 4 },
{ 0x0012fc, "\x64\x48\x8b\x04\x25\x28\x00", 7 },
{ 0x001303, "\x00\x00", 2 },
{ 0x001305, "\x48\x89\x45\xf8", 4 },
{ 0x001309, "\x31\xc0", 2 },
{ 0x00130b, "\x48\xc7\x45\xf0\x00\x00\x00", 7 },
{ 0x001312, "\x00", 1 },
{ 0x001313, "\x48\xc7\x45\xe8\x00\x00\x00", 7 },
{ 0x00131a, "\x00", 1 },
{ 0x00131b, "\xc7\x45\xe4\x00\x00\x00\x00", 7 },
{ 0x001322, "\x83\x7d\xdc\x02", 4 },
{ 0x001326, "\x74\x28", 2 },
{ 0x001328, "\x48\x8d\x05\xd9\x0c\x00\x00", 7 },
{ 0x00132f, "\x48\x89\xc7", 3 },
{ 0x001332, "\xe8\x09\xfe\xff\xff", 5 },
{ 0x001337, "\x48\x8d\x05\xec\x0c\x00\x00", 7 },
{ 0x00133e, "\x48\x89\xc7", 3 },
{ 0x001341, "\xe8\xfa\xfd\xff\xff", 5 },
{ 0x001346, "\xbf\x01\x00\x00\x00", 5 },
{ 0x00134b, "\xe8\x90\xfe\xff\xff", 5 },
{ 0x001350, "\x48\x8b\x45\xd0", 4 },
{ 0x001354, "\x48\x83\xc0\x08", 4 },
{ 0x001358, "\x48\x8b\x00", 3 },
{ 0x00135b, "\x48\x8d\x55\xe8", 4 },
{ 0x00135f, "\x48\x89\xd6", 3 },
{ 0x001362, "\x48\x89\xc7", 3 },
{ 0x001365, "\xe8\x48\x00\x00\x00", 5 },
{ 0x00136a, "\x48\x89\x45\xf0", 4 },
{ 0x00136e, "\x48\x83\x7d\xf0\x00", 5 },
{ 0x001373, "\x74\x22", 2 },
{ 0x001375, "\x48\x8b\x55\xe8", 4 },
{ 0x001379, "\x48\x8b\x45\xf0", 4 },
{ 0x00137d, "\x48\x89\xd6", 3 },
{ 0x001380, "\x48\x89\xc7", 3 },
{ 0x001383, "\xe8\x75\x02\x00\x00", 5 },
{ 0x001388, "\x89\x45\xe4", 3 },
{ 0x00138b, "\x48\x8b\x45\xf0", 4 },
{ 0x00138f, "\x48\x89\xc7", 3 },
{ 0x001392, "\xe8\x89\xfd\xff\xff", 5 },
{ 0x001397, "\xb8\x00\x00\x00\x00", 5 },
{ 0x00139c, "\x48\x8b\x55\xf8", 4 },
{ 0x0013a0, "\x64\x48\x2b\x14\x25\x28\x00", 7 },
{ 0x0013a7, "\x00\x00", 2 },
{ 0x0013a9, "\x74\x05", 2 },
{ 0x0013ab, "\xe8\xc0\xfd\xff\xff", 5 },
{ 0x0013b0, "\xc9", 1 },
{ 0x0013b1, "\xc3", 1 },
produced 52 bytes of output
``

Here, the C-struct is defined as:

```c
typedef struct 
{
    uint32_t addr;
    void *ops;
    size_t len;
}
operations_t;
```
